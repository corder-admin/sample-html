# 業者見積単価ダッシュボード 機能ガイド

## 概要

本ダッシュボードは、建設業者見積データの検索・分析・可視化を効率的に実行できる総合分析ツールです。
大東建託様のデータを活用し、実行単価の傾向分析、業者比較、時系列推移など、多角的な視点からコスト分析を支援します。

---

## 1. 条件検索機能

### 機能概要

多様な検索条件を組み合わせて、目的のデータを素早く絞り込むことができます。

### 検索条件の種類

#### 工事情報

- **工事名称**: オートコンプリート対応（部分一致検索）
- **支店名**: 複数選択可能（チェックボックス形式）
- **大工事項目コード**: 026（パネル工事等）をフィルタリング
- **発注日**: 期間指定（開始日〜終了日）

#### 項目情報

- **小工事項目名称**: キーワード検索（部分一致）
- **業者名**: 業者名による絞り込み（部分一致）

#### 建物情報

- **地上階数**: 範囲指定（1〜3 階）
- **戸並び**: 範囲指定（1〜55 戸）
- **居住用戸数**: 範囲指定（1〜12 戸）
- **施工面積**: 範囲指定（㎡ 単位）
- **延床面積**: 範囲指定（㎡ 単位）

---

## 2. 時系列一覧表示機能

### 機能概要

検索結果を**小工事項目別**でグループ化し、
各カード内で発注日の時系列順に詳細データを展開表示できます。

### 表示内容

#### カードヘッダー（常時表示）

- **項目名称**: 小工事項目名（例: 「金属パネル加工」）
- **単位**: 単位表示（例: 「㎡」「枚」「m」）
- **件数バッジ**: 該当レコード数（例: 「15 件」）
- **実行単価レンジ**: 最小値〜最大値（¥ 表示）

#### 業者別サマリー（折りたたみ式）

- **業者名**: 会社名（株式会社等は除去して表示）
- **発注件数**: 業者ごとの件数バッジ
- **単価統計**: 最小・平均・最大（¥ 表示）

#### 時系列詳細データ（展開式）

- **発注年月**: 年月ラベル（例: 2023 年 7 月）
- **バッジ情報**: 支店、大工事、階数、戸並、戸数
- **工事名称**: プロジェクト名
- **実行単価**: 単価（強調表示）
- **業者名**: 発注業者
- **実行数量**: 数量と単位
- **施工面積**: ㎡ 単位
- **延床面積**: ㎡ 単位
- **実行金額**: 金額（ハイライト表示）

---

## 3. 実行単価時系列分析機能

### 機能概要

「単価推移」ボタンから、選択した工事項目の実行単価を
**週次・月次・年次**でグラフ化し、時間軸での価格変動を可視化します。

### 表示モード

#### チャートモード

- **折れ線グラフ**: 平均値、最小値、最大値、中央値の 4 系列を同時表示
- **面グラフ**: 平均値を塗りつぶし表示で傾向を強調
- **棒グラフ**: 期間ごとの単価を棒で比較

#### テーブルモード

- **週次グループ**: 発注週ごとにレコードをテーブル表示
- **統計サマリー**: 各週の最小・平均・最大を表示
- **詳細データ**: 発注日、支店、工事名、業者、数量、単価、金額等を全項目表示

### グラフの見方

```text
チャート構成:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  最大値 ········ (赤色破線)

  平均値 ────── (青色実線・太) ← メインライン

  中央値 ────── (オレンジ色実線)

  最小値 ········ (緑色破線)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
         週次ラベル（例: 2023-07-03）
```

### 統計指標の意味

| 指標       | 定義                     | 説明                             |
| ---------- | ------------------------ | -------------------------------- |
| **平均値** | 合計 ÷ 件数              | 全体の中心的な単価水準           |
| **中央値** | データを並べた真ん中の値 | 外れ値の影響を受けにくい標準単価 |
| **最小値** | 期間内の最も低い単価     | 最安値の把握                     |
| **最大値** | 期間内の最も高い単価     | 最高値の把握、外れ値検出         |

---

## 4. 実行単価比較分析機能

### 機能概要

「多角分析」モーダルの**比較分析タブ**で、
支店別・業者別・工事種別・建物タイプ別など、様々な軸で単価を比較できます。

### 比較軸の種類

| 比較軸           | 説明                           |
| ---------------- | ------------------------------ |
| **支店別**       | 各支店の平均/中央値を比較      |
| **業者別**       | 発注業者ごとの単価比較         |
| **大工事項目別** | 工事種別ごとの単価比較         |
| **建物タイプ別** | 階数・戸数等の組み合わせで比較 |

### 表示形式

#### 棒グラフ（デフォルト）

- **平均値/中央値**: 選択した指標を棒グラフで表示
- **件数順ソート**: データ件数が多い順に表示

#### 箱ひげ図（Box Plot）

- **分布可視化**: データの散らばりを箱と線で表現
  - **箱の範囲**: 中央 50%のデータ（Q1〜Q3）
  - **中央線**: 中央値
  - **ひげ**: 通常範囲（箱の 1.5 倍まで）
  - **外れ値**: 赤色の点で表示

#### レーダーチャート

- **多軸比較**: 複数の比較軸を円形で可視化
- **バランス確認**: 各軸の値を放射状に配置

### 指標の選択

- **平均値モード**: 全データの平均で比較
- **中央値モード**: 外れ値の影響を除外した標準値で比較

---

## 5. 実行単価傾向分析機能

### 機能概要

「多角分析」モーダルの**傾向分析タブ**で、
建物属性（総戸数、階数、面積等）と実行単価の**相関関係**を
散布図・バブルチャート・ヒートマップで可視化します。

### X 軸（要因）の選択

| 要因         | 説明               |
| ------------ | ------------------ |
| **総戸数**   | 居住用戸数         |
| **階数**     | 地上階数           |
| **延床面積** | 建物全体の床面積   |
| **施工面積** | 実際の施工対象面積 |

### 表示形式

#### 散布図（Scatter Chart）

- **X 軸**: 選択した要因（例: 総戸数）
- **Y 軸**: 実行単価（円/単位）
- **各点**: 1 件のレコード
- **相関係数表示**: 2 変数間の相関の強さ（-1〜+1）

#### バブルチャート

- **散布図に追加**: 円の大きさで第 3 の変数を表現
- **サイズ選択**:
  - **数量モード**: 実行数量が多いほど大きい円
  - **金額モード**: 実行金額（数量 × 単価）が大きいほど大きい円
- **3 次元分析**: X 軸、Y 軸、サイズの 3 変数を同時に可視化

#### ヒートマップ

- **X 軸・Y 軸を範囲分割**: 両軸を 5 つのバケットに分割
- **セルの色濃度**: 該当件数が多いほど濃い青色
- **集中エリアの特定**: データが密集している価格帯・属性帯を可視化

### 相関係数の見方

| 相関係数       | 関係性           | 意味                        |
| -------------- | ---------------- | --------------------------- |
| **+0.7〜+1.0** | 強い正の相関     | X 増加 → Y 増加（右上がり） |
| **+0.4〜+0.7** | 中程度の正の相関 | やや右上がり                |
| **-0.1〜+0.1** | ほぼ無相関       | 関係性なし（散らばり）      |
| **-0.4〜-0.7** | 中程度の負の相関 | やや右下がり                |
| **-0.7〜-1.0** | 強い負の相関     | X 増加 → Y 減少（右下がり） |

---

## 共通フィルター機能（多角分析モーダル）

### 概要

「多角分析」モーダル内の全タブ（時系列分析、比較分析、傾向分析）で
共通して使用できるフィルター機能です。

### フィルター項目

| 項目     | 形式     | 説明                             |
| -------- | -------- | -------------------------------- |
| **期間** | 日付範囲 | 発注日の開始〜終了を指定         |
| **支店** | 複数選択 | 対象支店をチェックボックスで選択 |
| **業者** | 複数選択 | 対象業者をチェックボックスで選択 |

### 動作

1. フィルター条件を変更
2. 自動的に全タブのデータが再計算
3. KPI サマリー（件数、最小、平均、中央値、最大）も更新
